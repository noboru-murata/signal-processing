#+TITLE: デジタル信号処理
#+SUBTITLE: 信号処理 - 講義14
#+AUTHOR: 村田 昇
#+EMAIL: noboru.murata@eb.waseda.ac.jp
#+DATE:
# Time-stamp: <2021-06-03 13:59:42 mura>
:reveal:
#+INCLUDE: "./reveal.js/org/mycourse.org"
#+STARTUP: hidestars content
# C-c C-x C-v でinlineを切り替え
# <m C-i でlatex block (math env用)
# C-c '
:end:

* 前回のおさらい
** デジタル信号処理
   - 計算機で信号を扱うための方法論
     - 連続時間では扱えない
     - 有限長のデータしか扱えない
   - 処理の流れ
     - アナログ信号をデジタル信号に変換 (A/D変換)
       - 標本化 (sampling): 時間の離散化
     - 計算機上でデジタル信号を処理
     - デジタル信号をアナログ信号に変換 (D/A変換)

** 標本化定理
   - 定理
     #+begin_quote
     信号 \(f(t)\) が \(B\,[\mathrm{Hz}]\) 未満の周波数 (Nyquist周波数)しか含んでいないなら，
     サンプリング周波数 \(2B\,[\mathrm{Hz}]\) を用いて元の信号は完全に求められる．
     #+end_quote
     #+NAME: fig:draw10
     #+ATTR_HTML: :width 60%
     #+ATTR_LATEX: :width 0.5\linewidth
     [[file:figs/信号処理 10.png]]

** エイリアシング
   - 折り返しによる雑音
     #+begin_quote
     \(4\pi B\)
     周期の関数
     \(\tilde{f}\)
     を構成する際に重なりが生じ，
     \((-2\pi B,2\pi B)\)
     領域を切り出しても
     元に戻すことができない．
     #+end_quote
   #+NAME: fig:draw8
   #+ATTR_HTML: :width 60%
   #+ATTR_LATEX: :width 0.5\linewidth
   [[file:figs/信号処理 8.png]]

** 離散 Fourier 変換と逆変換
   - 定義
     #+begin_quote
     長さ \(N\) の信号 \(f(t),\;t=0,1,\dotsc,N{-}1\) の離散 Fourier 変換を以下で定義する．
     #+begin_src latex
       \begin{equation}
	 \hat{f}(n)
	 =\frac{1}{\sqrt{N}}\sum_{t=0}^{N{-}1}
	 f(t)e^{-i\frac{2\pi}{N}nt}, \quad (n=0,1,2,\dotsc,N{-}1)
       \end{equation}
       \begin{equation}
	 f(t)
	 =\frac{1}{\sqrt{N}}\sum_{n=0}^{N{-}1}
	 \hat{f}(n)e^{i\frac{2\pi}{N}nt}, \quad (t=0,1,2,\dotsc,N{-}1)
       \end{equation}
     #+end_src
     #+end_quote
** 行列による表現
   - 変換行列
     #+begin_quote
     #+begin_src latex
       \begin{equation}
         F
	 =
         \frac{1}{\sqrt{N}}
	 \begin{pmatrix}
	   1&1&1&\dots&1\\
	   1&\alpha^{-1}&\alpha^{-2}&\dots&\alpha^{-(N{-}1)}\\
	   \vdots&&&\ddots&\vdots\\
	   1&\alpha^{-(N{-}1)}&\alpha^{-2(N{-}1)}&\dots&\alpha^{-(N{-}1)(N{-}1)}
	 \end{pmatrix}
       \end{equation}
       \begin{equation}
	 \alpha=e^{i\frac{2\pi}{N}}
       \end{equation}
     #+end_src
     #+end_quote
   #+reveal: split
   - 逆変換行列
     #+begin_quote
     #+begin_src latex
       \begin{equation}
         F^{*}
	 =\frac{1}{\sqrt{N}}
	 \begin{pmatrix}
	   1&1&1&\dots&1\\
	   1&\alpha^{1}&\alpha^{2}&\dots&\alpha^{(N{-}1)}\\
	   \vdots&&&\ddots&\vdots\\
	   1&\alpha^{(N{-}1)}&\alpha^{2(N{-}1)}&\dots&\alpha^{(N{-}1)(N{-}1)}
	 \end{pmatrix}
       \end{equation}
     #+end_src
     #+end_quote
   #+reveal: split
   - 行列表現
     #+begin_quote
     #+begin_src latex
       \begin{equation}
	 \begin{pmatrix}
	   \hat{f}(0)\\
	   \hat{f}(1)\\
	   \vdots\\
	   \hat{f}(N{-}1)
	 \end{pmatrix}
	 =
         F
	 \begin{pmatrix}
	   f(0)\\
	   f(1)\\
	   \vdots\\
	   f(N{-}1)
	 \end{pmatrix}
       \end{equation}
       \begin{equation}
         \hat{\boldsymbol{f}}
         =F
         \boldsymbol{f}
       \end{equation}
       \begin{equation}
	 \boldsymbol{f}
	 =F^{*}
	 \hat{\boldsymbol{f}}
       \end{equation}
     #+end_src
     #+end_quote

** デジタル信号におけるフィルタの表現
   - 標本化されたフィルタの表現 (周期関数の畳み込み)
     #+begin_quote
     #+begin_src latex
       \begin{align}
         g(t)
         &=f{*}h(t)\\
         &=\sum_{s=0}^{N-1}f(s)h(t{-}s)
         =\sum_{s=0}^{N-1}f(t{-}s)h(s),\\
         &\quad t=0,1,\dotsc,N-1
       \end{align}
     #+end_src
     - \(f,g,h\): 周期 \(N\) の関数
     #+end_quote
** 有限長のデータ
   - 信号の一部の切り出し
     - 周期的な信号として扱う 
     - 有界な台を持つ信号として扱う
     #+begin_quote
     #+begin_src latex
       \begin{equation}
         f(t)=w(t)\tilde{f}(t)
       \end{equation}
     #+end_src
     #+end_quote
   - 端点での不連続性を軽減するために窓関数を導入
     - 矩形窓 (単純な切り出し)
     - gauss 窓
     - hann 窓
     - hamming 窓

** スペクトログラム
   #+NAME: fig:original_voice
   #+ATTR_HTML: :width 100%
   #+ATTR_LATEX: :width 0.5\linewidth
   [[file:figs/original_voice.png]]
   #+REVEAL_HTML: <audio controls src="figs/original_voice.wav"></audi>
** 加工後 (ローパスフィルタ)
   #+NAME: fig:lowpass_voice
   #+ATTR_HTML: :width 100%
   #+ATTR_LATEX: :width 0.5\linewidth
   [[file:figs/lowpass_voice.png]]
   #+REVEAL_HTML: <audio controls src="figs/lowpass_voice.wav"></audi>
** 加工後 (ハイパスフィルタ)
   #+NAME: fig:highpass_voice
   #+ATTR_HTML: :width 100%
   #+ATTR_LATEX: :width 0.5\linewidth
   [[file:figs/highpass_voice.png]]
   #+REVEAL_HTML: <audio controls src="figs/highpass_voice.wav"></audi>
   

* COMMENT 課題の説明
** COMMENT 注意
   - 提出するのは解答用紙1枚のみ
   - 形式はPDFまたは画像
   - 提出物が可読でない場合は評価できない


* COMMENT ローカル変数
# Local Variables:
# org-latex-listings: minted
# End:
      
  
   
   
