<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>線形フィルタ</title>
<meta name="author" content="村田 昇"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/oer-reveal.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/plugin/toc-progress/toc-progress.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/toc-style.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/fonts/source-sans-pro/source-sans-pro.css"/>

<link rel="stylesheet" href="./reveal.js/plugin/accessibility/helper.css"/>

<link rel="stylesheet" href="./reveal.js/dist/theme/mycourse.css"/>
<link rel="stylesheet" href="./reveal.js/plugin/highlight/zenburn.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-state="no-toc-progress">
<!-- This is an HTML template for the title slide. -->
<!-- Embed logos as necessary. -->
<!-- <a class="nooutlink" href="url"><img class="state-background your-logo-class" src="whatever.png" alt="Whatever" /></a> -->
<div class="talk-title">
    <h1 class="no-toc-progress">線形フィルタ</h1>
</div>
<div class="talk-subtitle">
    <p>信号処理 - 講義9</p>
</div>
<div class="keyboard-usage">
    <p>(Press <code>?</code> for help, <code>n</code> and <code>p</code> for next and previous slide)</p>
</div>
<div class="talk-author">
  <p>村田 昇<br />
  </p>
</div>

</section>

<section>
<section id="slide-orgcc063c7">
<h2 id="orgcc063c7">前回のおさらい</h2>
<div class="outline-text-2" id="text-orgcc063c7">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb2fcf99">
<h3 id="orgb2fcf99">Fourier 級数展開</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
\(f\in L^{2}(-\pi,\pi)\) 
は
以下のように
Fourier級数展開
される．
</p>
<div>
\begin{align}
  f(x)
  &=\sum_{n=-\infty}^{\infty}\langle f,\phi_{n}\rangle\phi_{n}(x)
\end{align}

</div>

<div>
\begin{equation}
  \phi_{n}(x)=\frac{1}{\sqrt{2\pi}}e^{inx},\;n=0,\pm1,\pm2,\dotsc
\end{equation}

</div>

<p>
内積は \(f,g\in L^{2}(-\pi,\pi)\) に対して
以下で定義する．
</p>
<div>
\begin{equation}
  \langle f,g\rangle
  =\int_{-\pi}^{\pi}f(x)\overline{g(x)}dx
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbe73916">
<h3 id="orgbe73916">Fourier 変換と反転公式</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
\(\mathbb{R}\)
上の関数
\(f\)
に対して
</p>
<div>
\begin{align}
  \hat{f}(\omega)
  &=\frac{1}{\sqrt{2\pi}}
    \int_{-\infty}^{\infty}f(x)e^{-i\omega x}dx
  &\text{(Fourier変換)}\\
  f(x)
  &=\frac{1}{\sqrt{2\pi}}
    \int_{-\infty}^{\infty}\hat{f}(\omega)e^{i\omega x}d\omega
  &\text{(逆Fourier変換)}
\end{align}

</div>

<p>
で定義する．
</p>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org33bbffe">
<h3 id="org33bbffe">Parseval の定理</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
関数  \(f,g\) は \(f,g \in L^{1}(\mathbb{R})\cap L^{2}(\mathbb{R})\) とする．
このとき以下の関係が成り立つ．
</p>
<div>
\begin{equation}
  \int_{-\infty}^{\infty}f(x)\overline{g(x)}dx
  =
  \int_{-\infty}^{\infty}\hat{f}(\omega)\overline{\hat{g}(\omega)}d\omega
\end{equation}

</div>

<div>
\begin{equation}
  \langle f,g\rangle
  =
  \langle \hat{f},\hat{g}\rangle
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org4ba9d58">
<h3 id="org4ba9d58">Plancherel の定理</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
関数 \(f\) は \(f \in L^{1}(\mathbb{R})\cap L^{2}(\mathbb{R})\) とする．
このとき以下の関係が成り立つ．
</p>
<div>
\begin{equation}
  \int_{-\infty}^{\infty}|f(x)|^{2}dx
  =
  \int_{-\infty}^{\infty}|\hat{f}(\omega)|^{2}d\omega
\end{equation}

</div>

<div>
\begin{equation}
  \|f\|_{L^{2}}
  =
  \|\hat{f}\|_{L^{2}}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org2fc446d">
<h3 id="org2fc446d">Riemann-Lebesgue の補題</h3>
<ul>
<li><p>
定理
</p>
<blockquote>
<p>
関数 \(f\in L^{1}(\mathbb{R})\) は滑らかで
\(f'\in L^{1}(\mathbb{R})\) とする．
このとき以下の性質をもつ．
</p>
<div>
\begin{equation}
  \lim_{|\omega|\to\infty}\hat{f}(\omega)=0
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge14d3d6">
<h3 id="orge14d3d6">演算との関係</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">関数</th>
<th scope="col" class="org-left">Fourier変換</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(f'(x)\) (微分)</td>
<td class="org-left">\(i\omega\hat{f}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(f^{(k)}(x)\) (k階微分)</td>
<td class="org-left">\((i\omega)^{k}\hat{f}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(f*g(x)\) (畳み込み)</td>
<td class="org-left">\(\sqrt{2\pi}\hat{f}(\omega)\hat{g}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(T_{a}f(x)=f(x-a)\) (移動)</td>
<td class="org-left">\(e^{-ia\omega}\hat{f}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(D_{b}f(x)=f(bx)\) (拡大縮小)</td>
<td class="org-left">\({1}/{b}\cdot\hat{f}\left({\omega}/{b}\right)\)</td>
</tr>
</tbody>
</table>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org94dc56c" data-background="#fef4f4">
<h2 id="org94dc56c">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgbc188a6" data-background="#fef4f4">
<h3 id="orgbc188a6">練習問題</h3>
<ul>
<li><p>
関数
</p>
<blockquote>
<div>
\begin{equation}
  f(x)=\frac{1}{x-ia}\;(a>0)        
\end{equation}

</div>
</blockquote>
<p>
の Fourier 変換を求めよ．
</p>
<ul>
<li><i><span style="color:gray;">Fourier 変換と逆 Fourier 変換の関係を利用</span></i></li>
<li>複素積分を利用</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org682f66b" data-background="#fef4f4">
<h3 id="org682f66b">解答例</h3>
<ul>
<li><p>
Cauchy の積分定理
</p>
<blockquote>
<p>
\(f\) を正則関数とするとき以下が成り立つ
</p>
<div>
\begin{equation}
  \oint f(z)dz = 0
\end{equation}

</div>
</blockquote></li>
<li><p>
Cauchy の積分公式 (第2定理)
</p>
<blockquote>
<p>
\(f\) を正則関数とするとき以下が成り立つ
</p>
<div>
\begin{equation}
  f(c)
  =\frac{1}{2\pi i}\oint \frac{f(z)}{z-c}dz
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
留数定理 
</p>
<blockquote>
<p>
積分路が孤立特異点 \(c\) を含むとき以下が成り立つ
</p>
<div>
\begin{equation}
  \mathrm{Res}_{z=c}f(z)
  =\frac{1}{2\pi i}\oint f(z)dz
\end{equation}

</div>
</blockquote></li>
<li><p>
留数計算
</p>
<blockquote>
<p>
孤立特異点が1位の極なら以下で計算できる
</p>
<div>
\begin{equation}
  \mathrm{Res}_{z=c}f(z)
  =
  \lim_{z\to c}(z-c)f(z)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
以下の Fourier 変換を求める
</p>
<blockquote>
<div>
\begin{equation}
  \mathcal{F}[f](\omega)
  =\frac{1}{\sqrt{2\pi}}\int\frac{1}{x-ia}e^{-i\omega x}dx
\end{equation}

</div>
</blockquote></li>
<li><p>
被積分関数を以下で定義
</p>
<blockquote>
<div>
\begin{equation}
  g(z)=\frac{e^{-i\omega z}}{\sqrt{2\pi}(z-ia)}
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
積分路
</p>
<blockquote>
<p>
\(\omega<0\) のとき積分路を \(ia\) を含む \(x\) 軸と上半平面で考える
</p>

<p>
\(\omega>0\) のとき積分路は \(x\) 軸と下半平面で考える
</p>
</blockquote>
<ul>
<li>\(e^{-i\omega z},\;(\omega<0)\) が上半平面でどうなるか考えよ</li>
<li>\(e^{-i\omega z},\;(\omega>0)\) が下半平面でどうなるか考えよ</li>

</ul>
<blockquote>
<div>
\begin{equation}
  \oint g(z)dz
  =
  \int_{-\infty}^{\infty} g(x)dx +\text{(積分に寄与しない)}
  =\mathcal{F}[f](\omega)
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
留数
</p>
<blockquote>
<div>
\begin{equation}
  Res_{z=ia}g(z)
  =\lim_{z=ia}(z-ia)g(z)=\frac{e^{a\omega}}{\sqrt{2\pi}}
\end{equation}

</div>
</blockquote></li>
<li><p>
整理すると
</p>
<blockquote>
<div>
\begin{align}
  \mathcal{F}[f](\omega)
  &= 2\pi i Res_{z=ia}g(z)\\
  &=
    \begin{cases}
      i\sqrt{2\pi}e^{a\omega}, & \omega<0\\
      0, & \omega>0
    \end{cases}
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org871e026" data-background="#fef4f4">
<h3 id="org871e026">練習問題</h3>
<ul>
<li><p>
以下の関数の Fourier 変換を求めよ．
</p>
<blockquote>
<div>
\begin{align}
  &\frac{1}{x+ia}\;(a>0) \\       
  &\frac{a}{x^{2}+a^{2}}\;(a>0) \\
  & \left(\frac{\sin(x)}{x}\right)^{2}
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orge60df9d" data-background="#fef4f4">
<h3 id="orge60df9d">解答例</h3>
<ul>
<li><p>
以下の関係を利用すればよい
</p>
<blockquote>
<div>
\begin{align}
  \frac{1}{x+ia}
  &=-i\sqrt{2\pi}\hat{g}(-x)\\
  \frac{a}{x^{2}+a^{2}}
  &=\frac{a}{(x-ia)(x+ia)}\\
  &=\frac{1}{2i}\left(\frac{1}{x-ia}-\frac{1}{x+ia}\right)
\end{align}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section data-background="#fef4f4">
<ul>
<li><p>
積の Fourier 変換は畳み込みを利用すればよい
</p>
<blockquote>
<div>
\begin{equation}
  \mathcal{F}[f{*}f](\alpha)
  =\sqrt{2\pi}\cdot\hat{f}(\alpha)^{2}
\end{equation}

</div>
<div>
\begin{equation}
  \mathcal{F}[\Xi_{(-1,1)}](\alpha)
  =
  \sqrt{\frac{2}{\pi}}\frac{\sin(\alpha)}{\alpha}
  =\sqrt{\frac{2}{\pi}}\hat{f}(\alpha)
\end{equation}

</div>
<div>
\begin{align}
  \mathcal{F}[\hat{f}^{2}](\omega)
  &=
  \mathcal{F}^{-1}[\hat{f}^{2}](-\omega)
  =\frac{1}{\sqrt{2\pi}}f{*}f(-\omega)\\
  &=\frac{1}{\sqrt{2\pi}}
    \sqrt{\frac{\pi}{2}}^{2}\Xi_{(-1,1)}{*}\Xi_{(-1,1)}(-\omega)\\
  &=\sqrt{\frac{\pi}{8}}\Xi_{(-1,1)}{*}\Xi_{(-1,1)}(\omega)
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb01bb53">
<h3 id="orgb01bb53">Fourier 変換の例</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">関数</th>
<th scope="col" class="org-left">Fourier変換</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(\Xi_{(-1,1)}(x),\;x\in\mathbb{R}\)</td>
<td class="org-left">\(\sqrt{\frac{2}{\pi}}\frac{\sin\omega}{\omega}\)</td>
</tr>

<tr>
<td class="org-left">\(e^{-ax^{2}},\;x\in\mathbb{R}\)</td>
<td class="org-left">\(\frac{1}{\sqrt{2a}}e^{-\omega^{2}/4a}\)</td>
</tr>

<tr>
<td class="org-left">\(\frac{1}{x-ia},\;x\in\mathbb{R},a>0\)</td>
<td class="org-left">\(\sqrt{2\pi}ie^{a\omega}\Xi_{(-\infty,0)}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(\frac{1}{x+ia},\;x\in\mathbb{R},a>0\)</td>
<td class="org-left">\(-\sqrt{2\pi}ie^{-a\omega}\Xi_{(0,\infty)}(\omega)\)</td>
</tr>

<tr>
<td class="org-left">\(\frac{a}{x^{2}+a^{2}},\;x\in\mathbb{R},a>0\)</td>
<td class="org-left">\(\sqrt{\frac{\pi}{2}}e^{-a\vert\omega\vert}\)</td>
</tr>
</tbody>
</table>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org751bc8b">
<h2 id="org751bc8b">線形時不変フィルタ</h2>
<div class="outline-text-2" id="text-org751bc8b">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-org6c4fe49">
<h3 id="org6c4fe49">注意</h3>
<ul>
<li>以降，音声や音楽などの時系列信号を扱う</li>
<li><p>
時間 \(t\) を明示的に表すために
</p>
<blockquote>
<div>
\begin{equation}
  f(t),\,g(t),\,h(t)
\end{equation}

</div>
</blockquote>
<p>
のように書く
</p></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org71dc772">
<h3 id="org71dc772">フィルタ</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
入力 \(f(t)\) を変換して出力 \(g(t)\) を生成する機構
</p>
</blockquote>

<div id="org1afdd3c" class="figure">
<p><img src="figs/filter1.png" alt="filter1.png" width="100%" />
</p>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org124296f">
<h3 id="org124296f">フィルタの例</h3>
<ul>
<li><span style="color:darkgreen;">エレキギターのエフェクター</span> (effects unit, pedal)
<ul>
<li>歪み: オーバードライブ / ディストーション / ファズ</li>
<li>モジュレーション: コーラス / フランジャー / トレモロ</li>
<li>空間系: リバーブ / ディレイ</li>
<li>フィルタ: ワウ / ピッチシフター / ワーミー</li>
<li>その他:  イコライザー / コンプレッサー / ノイズゲート</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgdbf5146">
<h3 id="orgdbf5146">フィルタ</h3>
<ul>
<li>関数 \(f(t)\) を関数 \(g(t)\) に変換する</li>
<li>関数に作用する作用素(演算子)</li>
<li>いろいろな機能が有り得る</li>
<li>以降では理論的に扱い易い性質を想定</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgadc6c99">
<h3 id="orgadc6c99">線形性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
2つの入出力関係を考えたとき，
入力の線形結合がそのまま出力に反映される性質
</p>
</blockquote>

<div id="orgebf301c" class="figure">
<p><img src="figs/filter2.png" alt="filter2.png" width="100%" />
</p>
</div>

<div id="org5abb7f4" class="figure">
<p><img src="figs/filter3.png" alt="filter3.png" width="100%" />
</p>
</div></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc5e8d40">
<h3 id="orgc5e8d40">線形フィルタ</h3>
<ul>
<li>線形性を持つフィルタ</li>
<li><p>
入力の分解表現
</p>
<blockquote>
<p>
入力信号 \(f(t)\) を基底関数 \(\phi_{n}(t)\) を用いて分解
</p>
<div>
\begin{equation}
  f(t)=\sum_{n}a_{n}\phi_{n}(t)
\end{equation}

</div>
</blockquote></li>
<li><p>
フィルタによる基底関数の変換
</p>

<div id="org5b43f32" class="figure">
<p><img src="figs/filter4.png" alt="filter4.png" width="100%" />
</p>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
出力の分解表現
</p>
<blockquote>
<p>
出力信号 \(g(t)\) は変換された基底関数 \(\psi_{n}(t)\) の合成
</p>
<div>
\begin{equation}
  g(t)=\sum_{n}a_{n}\psi_{n}(t)
\end{equation}

</div>
</blockquote></li>
<li>入出力の基底の変換にだけ着目すれば十分</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgf27c5eb">
<h3 id="orgf27c5eb">非線形フィルタ</h3>
<ul>
<li>信号の変換において非線形作用を持つフィルタ</li>
<li>多くのフィルタは線形性を持っている</li>
<li><p>
<span style="color:darkgreen;">線形でない例</span> (エフェクタ)
</p>
<ul>
<li>ディストーション</li>
<li>オーバードライブ</li>

</ul>
<p>
入力信号の振幅の大きさによって歪みが生じる
</p></li>
<li>非線形フィルタでは出力から入力を再現することが難しい</li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org4caad7a">
<h3 id="org4caad7a">時不変性</h3>
<ul>
<li><p>
定義
</p>
<blockquote>
<p>
入力の時刻が \(s\) ずれた場合，出力も \(s\) だけずれる性質
</p>
</blockquote>
<ul>
<li>時間が経過してもフィルタの性質は変わらない</li>

</ul>

<div id="org7f88926" class="figure">
<p><img src="figs/filter5.png" alt="filter5.png" width="100%" />
</p>
</div></li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orge7bc427">
<h2 id="orge7bc427">フィルタの数学的表現</h2>
<div class="outline-text-2" id="text-orge7bc427">
</div>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orga06efab">
<h3 id="orga06efab">信号の近似</h3>
<ul>
<li><p>
信号 \(f(t)\) の階段関数近似
</p>
<blockquote>
<div>
\begin{equation}
  f_{\tau}(t)=\sum_{n} a_{n}\Delta(t{-}t_{n})
\end{equation}

</div>
</blockquote></li>
<li><p>
階段関数の基底
</p>
<blockquote>
<p>
\(\Delta(t)\) は
区間 \((0,\tau)\) で高さ1となる単一の矩形波で，
時間 \(t_{n}=n\tau\) だけシフトした矩形波の集合
</p>
<div>
\begin{equation}
  \Delta(t{-}t_{n})=\Delta(t{-}n\tau),\quad
  (n\text{ は整数})
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
矩形波(基底関数)の変換
</p>
<blockquote>
<p>
矩形波 \(\Delta(t)\) はフィルタによって
\(H(t)\) に変換される．
</p>
</blockquote>

<div id="orgfd5856c" class="figure">
<p><img src="figs/filter6.png" alt="filter6.png" width="100%" />
</p>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
時不変性
</p>
<blockquote>
<p>
矩形波 \(\Delta\) を平行移動したものは
フィルタの時不変性により \(H\) を平行移動したものとなる．
</p>
</blockquote>

<div id="orgf469f2d" class="figure">
<p><img src="figs/filter7.png" alt="filter7.png" width="100%" />
</p>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
線形性
</p>
<blockquote>
<p>
フィルタの線形性から入力を定数倍すると
出力も定数倍される．
</p>
</blockquote>

<div id="org33f0477" class="figure">
<p><img src="figs/filter8.png" alt="filter8.png" width="100%" />
</p>
</div></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
階段関数の変換
</p>
<blockquote>
<p>
階段関数 
</p>
<div>
\begin{equation}
  f_{\tau}(t)=\sum_{n}a_{n}\Delta(t{-}t_{n})
\end{equation}

</div>

<p>
はフィルタにより \(H\) の線形和である
</p>
<div>
\begin{equation}
  g_{\tau}(t)=\sum_{n}a_{n}H(t{-}t_{n})
\end{equation}

</div>

<p>
に変換される．
</p>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org9774b8e">
<h3 id="org9774b8e">積分による表現</h3>
<ul>
<li><p>
階段関数の係数
</p>
<blockquote>
<p>
信号 \(f(t)\) の階段関数近似の係数は
\(a_{n}=f(t_{n})=f(n\tau)\) とすれば良い．
</p>
<div>
\begin{align}
  f_{\tau}(t)&=\sum_{n}f(t_{n})\Delta(t{-}t_{n})
	       =\sum_{n}f(n\tau)\Delta(t{-}n\tau)\\
  g_{\tau}(t)&=\sum_{n}f(t_{n})H(t{-}t_{n})
	       =\sum_{n}f(n\tau)H(t{-}n\tau)
\end{align}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
矩形波の極限
</p>
<blockquote>
<p>
関数 \(\Delta(t)\) は
区間 \((0,\tau)\) で高さ1となる単一の矩形波なので，
極限は以下のようになる．
</p>
<div>
\begin{equation}
  \delta_{\tau}(t)=\Delta(t)/\tau
  \xrightarrow{\tau\to0}\delta(t)\;(\text{デルタ関数})
\end{equation}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
階段関数の極限
</p>
<blockquote>
<div>
\begin{align}
  f_{\tau}(t)
  &=\sum_{n}f(n\tau)\Delta(t{-}n\tau)/\tau\cdot\tau
  \xrightarrow{\tau\to0}\int f(s)\delta(t{-}s)ds\\
  g_{\tau}(t)
  &=\sum_{n}f(n\tau)H(t{-}n\tau)/\tau\cdot\tau
  \xrightarrow{\tau\to0}\int f(s)h(t{-}s)ds
\end{align}

</div>
<div>
\begin{equation}
  H(t)/\tau
  \xrightarrow{\tau\to0}h(t)
\end{equation}

</div>
</blockquote>
<ul>
<li>\(n\tau=s\) とおいて区分求積法の原理を用いればよい</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
フィルタの積分表現
</p>
<blockquote>
<div>
\begin{align}
  f(t)&=\int f(s)\delta(t{-}s)ds\\
  g(t)&=\int f(s)h(t{-}s)ds
\end{align}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-org0e46861">
<h3 id="org0e46861">インパルス応答</h3>
<ul>
<li><p>
変換された信号の表現(畳み込み積分)
</p>
<blockquote>
<div>
\begin{equation}
  g(t)=\int_{-\infty}^{\infty}f(s)h(t-s)ds
\end{equation}

</div>
</blockquote></li>
<li><p>
入力の表現
</p>
<blockquote>
<div>
\begin{equation}
  f(t)=\int_{-\infty}^{\infty}f(s)\delta(t-s)ds
\end{equation}

</div>
</blockquote>
<ul>
<li>\(f(s)\) は時刻 \(s\) のインパルス \(\delta(t-s)\) の高さ</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
フィルタの表現
</p>
<blockquote>
<div>
\begin{equation}
  h(t)
  =\int_{-\infty}^{\infty}\delta(s)h(t-s)ds
  =\int_{-\infty}^{\infty}h(s)\delta(t-s)ds
\end{equation}

</div>
</blockquote>
<ul>
<li>\(h(t)\) はフィルタに \(\delta(t)\) を入力した時の出力でもある</li>
<li>\(h(t)\) をフィルタの <b>インパルス応答</b> という</li>

</ul></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb487d6f">
<h3 id="orgb487d6f">因果的フィルタ</h3>
<ul>
<li><p>
音響信号などのフィルタのインパルス応答
</p>
<blockquote>
<div>
\begin{equation}
  h(t)=0\;(t<0)
\end{equation}

</div>
</blockquote>
<ul>
<li>時刻0にインパルスが入力される前には何も出力がされない</li>
<li><b>因果的</b> という</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
因果的フィルタの畳み込み
</p>
<blockquote>
<div>
\begin{equation}
  h(t-s)=0\;(t < s)
\end{equation}

</div>

<p>
時刻 \(t\) での出力は
時刻 \(t\) 以前での入力のみにより定まる
</p>
<div>
\begin{equation}
  g(t)=\int_{-\infty}^{t}f(s)h(t-s)ds
\end{equation}

</div>
</blockquote></li>

</ul>

<div class="slide-footer"><br></div>
</section>
<section id="slide-orgc3f1b5a">
<h3 id="orgc3f1b5a">非因果的フィルタ</h3>
<ul>
<li>理想的なローパスフィルタ <br />
(物理的な回路では作成することができない)</li>
<li>画像処理に用いられるフィルタ <br />
(画素の上下左右に因果律があるわけではない)</li>
<li>オフラインの信号処理 <br />
(時間遅れを許容するデジタル信号処理)</li>

</ul>


<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-orged12be1" data-background="#fef4f4">
<h2 id="orged12be1">演習</h2>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orge0a215f" data-background="#fef4f4">
<h3 id="orge0a215f">練習問題</h3>
<ul>
<li><p>
線形時不変フィルタの機能は
インパルス応答の畳み込み積分として表される．
</p>
<blockquote>
<div>
\begin{equation}
  g(t)
  =\int_{-\infty}^{\infty}h(t-s)f(s)ds
  = h{*}f(t)
\end{equation}

</div>
</blockquote>
<p>
これを Fourier 変換を用いて表せ．
</p></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section id="slide-orgb478f62">
<h3 id="orgb478f62">解答例</h3>
<ul>
<li><p>
入力信号 \(f\) とインパルス応答 \(h\) のFourier 変換
</p>
<blockquote>
<div>
\begin{align}
  \hat{f}(\omega)
  &=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(t)e^{-i\omega t}dt\\
  \hat{h}(\omega)
  &=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}h(t)e^{-i\omega t}dt
\end{align}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
出力信号 \(g\) のFourier 変換
</p>
<blockquote>
<div>
\begin{align}
  \hat{g}(\omega)
  &=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}g(t)e^{-i\omega t}dt\\
  &=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}
    \left(\int_{-\infty}^{\infty}h(t-s)f(s)ds\right) e^{-i\omega t}dt\\
  &=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
    h(t-s)f(s)e^{-i\omega(t-s)}e^{-i\omega s}dtds\\
  &=\sqrt{2\pi}
    \cdot\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}h(t-s)e^{-i\omega(t-s)}dt\\
  &\qquad\times\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(s)e^{-i\omega s}ds
\end{align}

</div>
</blockquote></li>

</ul>
<div class="slide-footer"><br></div>
</section>
<section>
<ul>
<li><p>
整理すると
</p>
<blockquote>
<div>
\begin{equation}
  \hat{g}(\omega)
  =
  \sqrt{2\pi}\cdot\hat{h}(\omega)\cdot\hat{f}(\omega)
\end{equation}

</div>
</blockquote></li>
<li><p>
時間 \(t\) に対して \(\omega\) は周波数に対応
</p>
<blockquote>
<p>
Fourier 変換した周波数領域で見ると
フィルタの機能は周波数毎の振幅と位相の変換として理解できる．
</p>
</blockquote></li>

</ul>



<div class="slide-footer"><br></div>
</section>
</section>
<section>
<section id="slide-org80fe46f">
<h2 id="org80fe46f">今回のまとめ</h2>
<ul>
<li>線形時不変フィルタ
<ul>
<li>線形性</li>
<li>時不変性</li>
<li>因果的フィルタ</li>

</ul></li>
<li>フィルタの数学的表現
<ul>
<li>階段関数近似</li>
<li>重ね合わせの原理</li>
<li>畳み込み積分</li>
<li>インパルス応答</li>

</ul></li>

</ul>
<div class="slide-footer"><br></div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/dist/reveal.js"></script>
<script src="./reveal.js/plugin/notes/notes.js"></script>
<script src="./reveal.js/plugin/search/search.js"></script>
<script src="./reveal.js/plugin/zoom/zoom.js"></script>
<script src="./reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: true,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: true,
hashOneBasedIndex: false,
pdfSeparateFragments: false,

overview: true,

transition: 'fade',
transitionSpeed: 'default',
spotlight: { size: 90, initialPresentationMode: false }, chalkboard: { toggleChalkboardButton: { left: '80px' }, toggleNotesButton: { left: '130px'}}, keyboard: { 69: function() { RevealChalkboard.toggleNotesCanvas() }, 87: function() { RevealChalkboard.toggleChalkboard() }, 67: function() { RevealChalkboard.clear() }, 82: function() { RevealChalkboard.reset() }, 68: function() { RevealChalkboard.download() }, 88: function() { RevealChalkboard.colorNext() }, 89: function() { RevealChalkboard.colorPrev() }, 84: function() { RevealSpotlight.toggleSpotlight() }, 81: function() { RevealSpotlight.togglePresentationMode()}},

// Plugins with reveal.js 4.x
plugins: [ RevealNotes, RevealSearch, RevealZoom, RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
{ src: './reveal.js/plugin/menu/menu.js'},
{ src: './reveal.js/plugin/chalkboard/chalkboard.js'},
{ src: './reveal.js/plugin/spotlight/spotlight.js'}]

});
</script>
</body>
</html>
